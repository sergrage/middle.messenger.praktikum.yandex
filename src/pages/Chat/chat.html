{{#> layouts/main title="Чат" }}
<div class="chat__threads">
    <div class="chat__profile">
        <a class="chat__profile__link" href="/">
            Профиль <span class="chat__profile__link-purple"><i class="fa-solid fa-angle-right"></i></span>
        </a>
    </div>
    <div class="chat__search">
        <input class="chat__search__input" type="text" name="search" placeholder="&#xf002; Поиск">
    </div>
    {{#each chatThreads}}
    <div class="chat__thread {{#if active}}chat__thread-active{{/if}}" >
        <div class="chat__thread__info">
            <div class="chat__thread__avatar"></div>
            <div class="chat__thread__title">
                <p class="chat__thread__name">{{name}}</p>
                <p class="chat__thread__lastText">
                    {{#if myLast}}
                    <span class="chat__thread__lastText-my">Вы:</span>
                    {{/if}}
                    {{lastText}}
                </p>
            </div>
        </div>
        <div class="chat__thread__status">
            <p class="chat__thread__time">{{time}}</p>
            {{#if new}}
            <div class="chat__thread__new">{{new}}</div>
            {{/if}}
        </div>
    </div>
    {{/each}}
</div>

    {{#if chatMessages.length}}
    <div class="chat__content">
    <div class="chat__content__head">
        <div class="chat__content__head__info">
            <div class="chat__thread__info">
                <div class="chat__thread__avatar chat__thread__avatar-small"></div>
                <div class="chat__thread__title">
                    <p class="chat__thread__name">Концерты</p>
                </div>
            </div>
        </div>
        <div class="chat__content__head__action">
            <span><i class="fa-solid fa-ellipsis-vertical"></i></span>
        </div>
    </div>
    <div class="chat__content__body">
        {{#each chatMessages}}
        <div class="chat__content__body__day">
            <div class="chat__content__body__day__date">
                {{day}}
            </div>
            {{#each messages}}
            {{#if img}}
            {{#if companion}}
            <div class="massage massage__imageWrap">
                <img class="massage__image" src="{{img}}" alt="{{alt}}">
                <span class="massage__image__time">{{time}}</span>
            </div>
            {{else}}
            <div class="massage massage-my massage__imageWrap">
                <img class="massage__image" src="{{img}}" alt="{{alt}}">
                <span class="massage__image__time">{{time}}</span>
            </div>
            {{/if}}
            {{else}}
            {{#if companion}}
            <div class="massage massage-companion">
                {{#each text}}
                {{#if @first}}
                <p class="m-0">{{this}}</p>
                {{else}}
                <p>{{this}}</p>
                {{/if}}
                {{/each}}
                <span class="massage-companion__time">{{time}}</span>
            </div>
            {{/if}}
            {{#if my}}
            <div class="massage massage-my">
                {{#each text}}
                {{#if @first}}
                <p class="m-0">{{this}}</p>
                {{else}}
                <p>{{this}}</p>
                {{/if}}
                {{/each}}
                <span class="massage-my__check"><i class="fa-solid fa-check-double"></i> {{time}} </span>
            </div>
            {{/if}}
            {{/if}}
            {{/each}}
        </div>
        {{/each}}
    </div>
    <div class="chat__content__footer">
        <div class="chat__content__footer__addFile">
            <span><i class="fa-solid fa-paperclip"></i></span>
        </div>
        <div class="chat__content__footer__inputWrap">
            <input type="text" class="chat__content__footer__input" name="message">
        </div>
        <div class="chat__content__footer__send">
            <span><i class="fa-solid fa-arrow-right"></i></span>
        </div>
    </div>
    </div>
    {{else}}
    <div class="chat__content chat__content-center">
    <div class="">
        <img src="./../../../static/icons/no-message-icon.svg" alt="no-message-icon">
        <p class="chat__content__no-message">Выберите чат чтобы отправить сообщение</p>
    </div>
    </div>

    {{/if}}


<script src="chat.js" type="module"></script>
{{/ layouts/main }}